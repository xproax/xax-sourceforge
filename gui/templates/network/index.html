{% extends "base.html" %}
{% block content %}
<div dojoType="dijit.MenuBar" id="navMenu" style="height:56px;">

            <div dojoType="dijit.MenuBarItem" onClick="window.location='/'" class="menu_icon">
        <img src="/freenas/media/images/ui/system.png" alt="System" />
        <br />
                <div>
                    System 
                </div>
            </div>

    <div dojoType="dijit.MenuBarItem" onClick="window.location='/network/'" class="menu_icon dijitMenuItemSelected">
        <img src="/freenas/media/images/ui/network.png" alt="Network" />
        <br />
        <span>
            Network 
        </span>
    </div>

    <div dojoType="dijit.MenuBarItem" onClick="window.location='/storage/'" class="menu_icon ">
        <img src="/freenas/media/images/ui/storage.png" alt="Storage" />
        <br />
        <span>
            Storage 
        </span>
    </div>

    <div dojoType="dijit.MenuBarItem" onClick="window.location='/sharing/'" class="menu_icon">
        <img src="/freenas/media/images/ui/sharing.png" alt="Sharing" />
        <br />
        <span>
            Sharing
        </span>
    </div>

    <div dojoType="dijit.MenuBarItem" onClick="window.location='/services/'" class="menu_icon">
        <img src="/freenas/media/images/ui/services.png" alt="Services" />
        <br />
        <span>
            Services
        </span>
    </div>


    {% if user.is_authenticated %}
    <div dojoType="dijit.MenuBarItem" onClick="window.location='/account/logout/'" class="menu_icon" style="float:right;">
        <img src="/freenas/media/images/ui/logout.png" alt="Log out" />
        <br />
        <span>
            Log Out 
        </span>
    </div>
    <div dojoType="dijit.MenuBarItem" onClick="window.location='/account/'" class="menu_icon" style="float:right;">
        <img src="/freenas/media/images/ui/account.png" alt="Account" />
        <br />
        <span>
            Account 
        </span>
    </div>
    {% else %}

    <div dojoType="dijit.MenuBarItem" onClick="window.location='/account/login/'" class="menu_icon" style="font-weight:bold;">
        <img src="/freenas/media/images/ui/login.png" alt="Log in" />
        <br />
        <span>
            Log In
        </span>
    </div>
    {% endif %}
</div>
{% endblock %}
{% block dojango_content %}
{% if user.is_authenticated %}
<div dojoType="dijit.layout.TabContainer" style="width:100%;" doLayout="false" >
    <div dojoType="dijit.layout.TabContainer" title="Network Settings" nested="true" doLayout="false">
        <div dojoType="dijit.layout.ContentPane" title="Global Configuration"{% if focus_form == "gc" %} selected="true"{% endif %}>
            <form action="/network/global/configuration/" method="post">{% csrf_token %}
            <table class="config">
                {% for field in gc %}
                <tr>
                    <td>
                        <label for="{{ field.auto_id }}">
                            {% if field.field.required %}
                                <span class="required">{{ field.label }}</span>
                            {% else %}
                                {{ field.label }}
                            {% endif %}
                        </label>
                    </td>
                    <td>
                        {{ field }}
			{{ field.errors }}
                    </td>
                </tr>
            {% endfor %}
            </table>
            <p class="btn">
            <button dojoType="dijit.form.Button" type="submit">Save Configuration</button>
            </p>
            </form>
        </div>
        <div dojoType="dijit.layout.ContentPane" title="Interfaces"{% if focus_form == "int" %} selected="true"{% endif %}>
            <table class="grid">
	            <thead class="header">
			<tr>
		            <td>Interface</td>
		            <td>Name</td>
		            <td>DHCP</td>
		            <td>IPv4 Address</td>
		            <td>IPv4 Netmask</td>
		            <td>IPv6 Auto</td>
		            <td>IPv6 Address</td>
		            <td>IPv6 Netmask</td>
		            <td>Options</td>
			</tr>
		        </thead>
                {% for i in int_list %}
                <tr class="{% cycle 'odd' 'even' %}" id="{{ i.id }}">
                    <td>{{ i.int_interface }}</td>
                    <td>{{ i.int_name }}</td>
                    <td>{{ i.int_dhcp }}</td>
                    {% if i.int_ipv4address != "0.0.0.0" %}
                    <td>{{ i.int_ipv4address }}</td>
                    <td>/{{ i.int_v4netmaskbit }}</td>
                    {% else %}
                    <td></td>
                    <td></td>
                    {% endif %}
                    <td>{{ i.int_ipv6auto }}</td>
                    {% if i.int_ipv6address != "::" %}
                    <td>{{ i.int_ipv6address }}</td>
                    <td>/{{ i.int_v6netmaskbit }}</td>
                    {% else %}
                    <td></td>
                    <td></td>
                    {% endif %}
                    <td>{{ i.int_options }}</td>
                    <td>
                        <button dojoType="dijit.form.Button" type="button" onClick="window.location='/network/int/edit/{{ i.id }}/'">Edit</button>
                        <button dojoType="dijit.form.Button" type="button" onClick="window.location='/network/int/delete/{{ i.id }}/'">Delete</button>
                    </td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="9">No interfaces defined</td>
                </tr>
                {% endfor %}
                </table>
                <p class="btn">
                    <button id="int_button" dojoType="dijit.form.Button" type="button">
                        Add Interface
                        <script type="dojo/method" event="onClick" args="evt">
                        dijit.byId("int").show();
                    </script>
                    </button>
                    </p>
        </div>
        <div dojoType="dijit.layout.ContentPane" title="VLAN"{% if focus_form == "vlan" %} selected="true"{% endif %}>
              <table class="grid">
	            <thead class="header">
			<tr>
		            <td>Virtual Interface</td>
		            <td>Physical Interface</td>
		            <td>VLAN Tag</td>
		            <td>Description</td>
			</tr>
		        </thead>
                {% for v in vlan_list %}
                <tr class="{% cycle 'odd' 'even' %}" id="{{ v.id }}">
                    <td>{{ v.vlan_vint }}</td>
                    <td>{{ v.vlan_pint }}</td>
                    <td>{{ v.vlan_tag }}</td>
                    <td>{{ v.vlan_description }}</td>
                    <td>
                        <button dojoType="dijit.form.Button" type="button" onClick="window.location='/network/vlan/edit/{{ v.id }}/'">Edit</button>
                        <button dojoType="dijit.form.Button" type="button" onClick="window.location='/network/vlan/delete/{{ v.id }}/'">Delete</button>
                    </td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="4">No VLAN defined</td>
                </tr>
                {% endfor %}
                </table>
                <p class="btn">
                    <button id="vlan_button" dojoType="dijit.form.Button" type="button">
                        Add VLAN Interface
                        <script type="dojo/method" event="onClick" args="evt">
                        dijit.byId("vlan").show();
                    </script>
                    </button>
                    </p>
        </div>
        <div dojoType="dijit.layout.ContentPane" title="LAGG"{% if focus_form == "lagg" %} selected="true"{% endif %}>
            <table class="grid">
	            <thead class="header">
			<tr>
		            <td>Virtual Interface</td>
		            <td>Actions</td>
			</tr>
		        </thead>
                {% for l in lagg_list %}
                <tr class="{% cycle 'odd' 'even' %}" id="{{ l.id }}">
                    <td>{{ l }}</td>
                    <td>
                        <button dojoType="dijit.form.Button" type="button" onClick="window.location='/network/int/edit/{{ l.lagg_interface.id }}/'">Edit Interface</button>
                        <button dojoType="dijit.form.Button" type="button" onClick="window.location='/network/laggmembers/view/{{ l.id }}/'">Edit Members</button>
                        <button dojoType="dijit.form.Button" type="button" onClick="window.location='/network/int/delete/{{ l.lagg_interface.id }}/'">Delete</button>
                    </td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="2">No LAGG interface defined</td>
                </tr>
                {% endfor %}
                </table>

                <p class="btn">
                    <button id="lagg_button" dojoType="dijit.form.Button" type="button">
                       Add LAGG Interface 
                        <script type="dojo/method" event="onClick" args="evt">
                        dijit.byId("lagg").show();
                    </script>
                    </button>
                    </p>
        </div>
        <div dojoType="dijit.layout.ContentPane" title="Static Routes"{% if focus_form == "sr" %} selected="true"{% endif %}>
            <table class="grid">
                <thead class="header">
		    <tr>
                    <td>Destination</td>
		            <td>Gateway</td>
		            <td>Description</td>
		            <td>Actions</td>
		    </tr>
		        </thead>
                {% for i in sr_list %}
                    <tr class="{% cycle 'odd' 'even' %}" id="{{ i.id }}">
                        <td>{{ i.sr_destination }}</td>
                        <td>{{ i.sr_gateway }}</td>
                        <td>{{ i.sr_description }}</td>
                        <td>
                            <button dojoType="dijit.form.Button" type="button" onClick="window.location='/network/sr/edit/{{ i.id }}/'">Edit</button>
                            <button dojoType="dijit.form.Button" type="button" onClick="window.location='/network/sr/delete/{{ i.id }}/'">Delete</button>
                        </td>
                    </tr>
		        {% empty %}
                    <tr>
                        <td colspan="3">No static route defined</td>
                    </tr>
                {% endfor %}
            </table>

            <button id="sr_button" dojoType="dijit.form.Button" type="button">
                Add Static Route 
            <script type="dojo/method" event="onClick" args="evt">
                dijit.byId("sr").show();
            </script>
	    </button>
        </div>
    </div>
</div>


<div id="int" dojoType="dijit.Dialog" closable="true" title="Add Interface">
    <form action="/network/global/int/" method="post">{% csrf_token %}
        <table>
            {{ interfaces }}
        </table>
        <button dojoType="dijit.form.Button" type="submit">Add Interface</button>
        <button dojoType="dijit.form.Button" type="button" onClick="dijit.byId('int').hide();">
            Cancel
        </button>
    </form>
</div>

<div id="vlan" dojoType="dijit.Dialog" closable="true" title="Add VLAN">
    <form action="/network/global/vlan/" method="post">{% csrf_token %}
        <table>
            {{ vlan }}
        </table>
        <button dojoType="dijit.form.Button" type="submit">Add VLAN</button>
        <button dojoType="dijit.form.Button" type="button" onClick="dijit.byId('vlan').hide();">
            Cancel
        </button>
    </form>
</div>

<div id="lagg" dojoType="dijit.Dialog" closable="true" title="Add LAGG">
    <form action="/network/global/lagg/" method="post">{% csrf_token %}
        <table>
            {{ lagg }}
        </table>
        <button dojoType="dijit.form.Button" type="submit">Add LAGG</button>
        <button dojoType="dijit.form.Button" type="button" onClick="dijit.byId('lagg').hide();">
            Cancel
        </button>
    </form>
</div>

<div id="sr" dojoType="dijit.Dialog" closable="true" title="Add Static Route">
    <form action="/network/global/sr/" method="post">{% csrf_token %}
        <table>
            {{ staticroute }}
        </table>
        <button dojoType="dijit.form.Button" type="submit">Add Static Route</button>
        <button dojoType="dijit.form.Button" type="button" onClick="dijit.byId('sr').hide();">
            Cancel
        </button>
    </form>
</div>
            
{% else %}
    <p>Welcome. Please <a href="/freenas/login/">log in</a>.</p>
{% endif %}

{% endblock %}

